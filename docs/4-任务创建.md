# 任务的创建

除了引导进程 initproc 外，其他进程/线程都是通过 fork/exec 系统调用产生的。 

在 sys_do_fork 函数中，我们根据 CloneFlags 参数为子进程/子线程创建 TCB，包括创建虚拟地址空间，将其加入到全局等待队列中。

对于子进程的虚拟地址空间 MemorySet ，我们并不会立刻对齐分配物理页帧，而是将其指向父进程对应的物理页帧，同时将页表项 PTEFlags 中的可写标志位 (若存在) 置零。这样，当子进程访问到对应的物理页帧时，会引发又一次 trap，而在这次 trap 的处理中，我们才对子进程分配实际的物理页帧，同时恢复相应页表项的标志位。由此实现地址空间的写时复制 (COW)。

